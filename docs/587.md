# Java Regex -正则表达式语法

> 原文：<https://jenkov.com/tutorials/java-regex/syntax.html>

要在 Java 中有效地使用正则表达式，您需要知道语法。语法非常广泛，使您能够编写非常高级的正则表达式。要完全掌握语法可能需要大量的练习。

在这篇课文中，我将通过例子来讲解语法的基本知识。我不会涉及语法的每一个细节，而是关注你需要理解的主要概念，以便使用正则表达式。要获得完整的解释，请参见 JavaDoc 页面的 [`Pattern`类。](http://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html)

## 基本语法

在展示可以在 Java 正则表达式中使用的所有高级选项之前，我将向您快速介绍一下 Java 正则表达式的语法基础。

### 特性

正则表达式的最基本形式是只匹配某些字符的表达式。这里有一个例子:

```
John

```

这个简单的正则表达式将匹配给定输入文本中出现的文本“John”。

您可以在正则表达式中使用字母表中的任何字符。

您也可以通过八进制、十六进制或 unicode 代码来引用字符。这里有两个例子:

```
\0101
\x41
\u0041

```

这三个表达式都是指大写的`A`字符。第一种使用八进制代码(`101`)表示`A`，第二种使用十六进制代码(`41`，第三种使用 unicode 代码(`0041`)。

### 字符类别

字符类的构造使您能够针对多个字符而不是一个字符指定匹配。换句话说，字符类将输入文本中的单个字符与字符类中允许的多个字符进行匹配。例如，您可以像这样匹配字符`a`、`b`或`c`:

```
[abc]

```

字符类嵌套在一对方括号`[]`中。括号本身不是匹配的一部分。

你可以在很多事情上使用字符类。例如，这个例子查找单词`John`的所有出现，无论是小写还是大写`J`:

```
[Jj]ohn

```

字符类`[Jj]`将匹配一个`J`或一个`j`，而表达式的其余部分将匹配该序列中的字符`ohn`。

您还可以使用其他几个字符类。参见本文后面的字符分类表。

### 预定义的字符类

Java 正则表达式语法有几个可以使用的预定义字符类。例如，`\d`字符类匹配任何数字，`\s`字符类匹配任何空白字符，`\w`字符匹配任何单词字符。

预定义的字符类不一定要用方括号括起来，但是如果您想合并它们，可以用方括号括起来。这里有几个例子:

```
\d
[\d\s]

```

第一个示例匹配任何数字字符。第二个示例匹配任何数字或任何空白字符。

本文后面的表格中列出了预定义的字符类。

### 边界匹配器

语法还包括匹配边界的匹配器，如单词之间的边界、输入文本的开头和结尾等。例如，`\w`匹配单词之间的边界，`^`匹配一行的开头，`$`匹配一行的结尾。

下面是一个边界匹配器示例:

```
^This is a single line$

```

这个表达式只匹配一行文本和文本`This is a single line`。请注意表达式中的行首和行尾匹配器。这些声明除了行首和行尾之外，文本前后不能有任何内容。

本文后面有一个完整的边界匹配器列表。

### 量词

量词使您能够多次匹配给定的表达式或子表达式。例如，以下表达式匹配字母`A`零次或多次:

```
A*

```

`*`字符是一个量词，表示“零次或多次”。还有一个表示“一次或多次”的量词“T1”，一个表示“零次或一次”的量词“T2”，以及其他一些量词，您可以在本文后面的量词表中看到。

量词可以是“勉强的”、“贪婪的”或“可能的”。不情愿的量词将匹配尽可能少的输入文本。贪婪量词将匹配尽可能多的输入文本。possive 量词将尽可能地匹配，即使它使表达式的其余部分不匹配任何内容，并且表达式无法找到匹配。

我将用一个例子来说明勉强的、贪婪的和可能的量词之间的区别。以下是输入文本:

```
John went for a walk, and John fell down, and John hurt his knee.

```

然后看下面这个带勉强量词的表达式:

```
John.*?

```

这个表达式将匹配单词`John`后跟零个或多个字符`.`表示“任何字符”，而`*`表示“零次或多次”。`*`后面的`?`使得`*`成为一个不情愿的量词。

作为一个不情愿的量词，量词会尽量少匹配，意思是零个字符。因此，表达式将在上面的输入文本中 3 次找到零字符的单词`John`。

如果我们将量词改为贪婪量词，表达式将如下所示:

```
John.*

```

贪婪量词将匹配尽可能多的字符。现在表达式将只匹配第一次出现的`John`，贪婪量词将匹配输入文本中的其余字符。因此，只找到一个匹配。

最后，让我们稍微修改一下表达式，以包含一个 possesive 量词:

```
John.*+hurt

```

`*`后面的`+`使其成为可能量词。

这个表达式将不匹配上面给出的输入文本，即使在输入文本中找到了单词`John`和`hurt`。这是为什么呢？因为`.*+`是可能的。不是像贪婪量词那样尽可能地匹配以使表达式匹配，而是尽可能地匹配，而不管表达式是否匹配。

`.*+`将匹配输入文本中第一次出现`John`之后的所有字符，包括单词`hurt`。因此，当 possesive 量词声称匹配时，就没有剩下的`hurt`单词可以匹配了。

如果将量词改为贪婪量词，表达式将匹配输入文本一次。下面是带有贪婪量词的表达式:

```
John.*hurt

```

你将不得不尝试不同的量词和类型来理解它们是如何工作的。有关量词的完整列表，请参见本文后面的表格。

### 逻辑运算符

Java 正则表达式语法还支持一些逻辑运算符(and、or、not)。

`and`操作符是隐式的。当你写下`John`这个表达时，它的意思是`J`和`o`和`h`和`n`。

`or`操作符是显式的，用一个`|`来写。例如，表达式`John|hurt`将匹配单词`John`或单词`hurt`。

## 特性

| 建造 | 比赛 |
| `x` | 字符 x。字母表中的任何字符都可以用来代替 x。 |
| `\\` | 反斜杠字符。单个反斜杠与其他字符一起用作转义字符，以表示特殊匹配，因此要仅匹配反斜杠字符本身，您需要用反斜杠字符进行转义。因此双反斜杠匹配单个反斜杠字符。 |
| `\0n` | 八进制值的字符`0n`。n 必须介于 0 和 7 之间。 |
| `\0nn` | 八进制值的字符`0nn`。n 必须介于 0 和 7 之间。 |
| `\0mnn` | 八进制值的字符`0mnn`。m 必须介于 0 和 3 之间，n 必须介于 0 和 7 之间。 |
| `\xhh` | 十六进制值的字符`0xhh`。 |
| `\uhhhh` | 十六进制值的字符`0xhhhh`。这个构造用于匹配 unicode 字符。 |
| `\t` | 制表符。 |
| `\n` | 换行符(换行符)(unicode: `'\u000A'`)。 |
| `\r` | 回车字符(unicode: `'\u000D'`)。 |
| `\f` | 换页字符(unicode: `'\u000C'`)。 |
| `\a` | 警报(铃声)字符(unicode: `'\u0007'`)。 |
| `\e` | 转义字符(unicode: `'\u001B'`)。 |
| `\cx` | 对应于`x`的控制字符 |
|  |  |

## 字符类别

| 建造 | 比赛 |
| `[abc]` | 匹配`a`，或`b`或`c`。这被称为简单类，它匹配类中的任何字符。 |
| `[^abc]` | 匹配除`a`、`b`和`c`之外的任何字符。这是一种否定。 |
| `[a-zA-Z]` | 匹配从`a`到`z`，或者`A`到`Z`的任意字符，包括`a`、`A`、`z`和`Z`。这叫做范围。 |
| `[a-d[m-p]]` | 匹配从`a`到`d`，或者从`m`到`p`的任意字符。这就是所谓的联盟。 |
| `[a-z&&[def]]` | 匹配`d`、`e`或`f`。这被称为交集(在这里是范围`a-z`和字符`def`之间)。 |
| `[a-z&&[^bc]]` | 匹配从`a`到`z`的所有字符，除了`b`和`c`。这叫做减法。 |
| `[a-z&&[^m-p]]` | 匹配从`a`到`z`的所有字符，除了从`m`到`p`的字符。这也叫减法。 |

## 预定义的字符类

| 建造 | 比赛 |
| `.` | 匹配任何单个字符。可能与行终止符匹配，也可能不匹配，这取决于编译`Pattern`时使用了什么标志。 |
| `\d` | 匹配任何数字[0-9] |
| `\D` | 匹配任何非数字字符[^0-9] |
| `\s` | 匹配任何空白字符(空格、制表符、换行符、回车符) |
| `\S` | 匹配任何非空白字符。 |
| `\w` | 匹配任何单词字符。 |
| `\W` | 匹配任何非单词字符。 |

## 边界匹配器

| 建造 | 比赛 |
| `^` | 匹配一行的开头。 |
| `$` | 匹配行尾。 |
| `\b` | 匹配单词边界。 |
| `\B` | 匹配非单词边界。 |
| `\A` | 匹配输入文本的开头。 |
| `\G` | 匹配前一个匹配的结尾 |
| `\Z` | 匹配输入文本的结尾，除了最后一个终止符(如果有)。 |
| `\z` | 匹配输入文本的结尾。 |

## 量词

| 贪婪的 | 不情愿的 | 所有格 | 比赛 |
| `X?` | `X??` | `X?+` | 匹配 X 一次，或者根本不匹配(0 或 1 次)。 |
| `X*` | `X*?` | `X*+` | 匹配 X 零次或多次。 |
| `X+` | `X+?` | `X++` | 匹配 X 一次或多次。 |
| `X{n}` | `X{n}?` | `X{n}+` | 与 X 精确匹配 n 次。 |
| `X{n,}` | `X{n,}?` | `X{n,}+` | 匹配 X 至少 n 次。 |
| `X{n, m)` | `X{n, m)?` | `X{n, m)+` | 匹配 X 至少 n 次，但最多 m 次。 |

## 逻辑运算符

| 建造 | 比赛 |
| `XY` | 匹配 X 和 Y (X 后跟 Y)。 |
| `X&#124;Y` | 匹配 X 或 y。 |