# java 注释

> 原文:[https://jenkov.com/tutorials/java/annotations.html](https://jenkov.com/tutorials/java/annotations.html)

Java 注释用于为 Java 代码提供元数据。作为元数据，Java 注释不会直接影响代码的执行，尽管某些类型的注释实际上可以用于此目的。

Java 注释是从 Java 5 添加到 Java 中的。本文涵盖了 Java 8、Java 9 及更高版本中的 Java 注释。据我所知，Java 注释在后来的 Java 版本中没有改变，所以这段文字对 Java 8、9、10 和 11 程序员也应该有效。

## Java 注释视频教程

我制作了一组视频，解释 Java 注释如何工作，以及如何创建自己的 Java 注释。以下是 YouTube 播放列表的链接: [Java 注释-播放列表](https://www.youtube.com/playlist?list=PLL8woMHwr36FSdBcnqZQKSAyshyN4nkVy)

这是 Java 注释视频教程播放列表中的第一个视频:

<iframe width="560" height="315" src="https://www.youtube.com/embed/0VPRkVWkM70" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""><h2>Java 注释目的</h2> <p>Java 注释通常用于以下目的:</p> <ul> <li>编译器指令</li> <li>构建时指令</li> <li>运行时指令</li> </ul> <p>Java 有 3 个内置的注释，可以用来给 Java 编译器提供指令。这些注释将在本文后面更详细地解释。</p> <p>当您构建软件项目时，可以在构建时使用 Java 注释。构建过程包括生成源代码、编译源代码、生成 XML 文件(例如部署描述符)、将编译后的代码和文件打包成 JAR 文件等。构建软件通常由自动构建工具完成，如 Apache Ant 或 Apache Maven。构建工具可能会扫描 Java 代码中的特定注释，并基于这些注释生成源代码或其他文件。</p> <h2>通过 Java 反射访问 Java 注释</h2> <p>通常，Java 注释不会出现在编译后的 Java 代码中。但是，您可以定义自己的注释，以便在运行时使用。然后这些注释可以通过<a href="/java-reflection/index.html"> Java 反射</a>访问，并用于给你的程序或一些第三方 API 提供指令。我已经在我的<a href="/java-reflection/annotations.html"> Java 反射和注释</a>教程中介绍了如何通过反射访问 Java 注释。</p> <h2>注释基础</h2> <p>最短形式的 Java 注释如下所示:</p> <pre class="codeBox"> @Entity </pre> <p>字符<code>@</code>通知编译器这是一个注释。<code>@</code>字符后面的名称是注释的名称。在上面的例子中，注释名是<code>Entity</code>。</p> <h3>注释元素</h3> <p>Java 注释可以包含一些元素，您可以为这些元素设置值。元素类似于属性或参数。下面是一个带有元素的 Java 注释示例:</p> <pre class="codeBox"> @Entity(tableName = "vehicles") </pre> <p>本例中的注释包含一个名为<code>tableName</code>的元素，其值设置为<code>vehicles</code>。元素包含在注释名后面的括号中。没有元素的注释不需要括号。</p> <p>一个注释可以包含多个元素。以下是一个多元素 Java 注释示例:</p> <pre class="codeBox"> @Entity(tableName = "vehicles", primaryKey = "id") </pre> <p>如果一个注释只包含一个元素，那么按照惯例将该元素命名为<code>value</code>，如下所示:</p> <pre class="codeBox"> @InsertNew(value = "yes") </pre> <p>当一个注释只包含一个名为<code>value</code>的元素时，可以省略元素名，只提供值。以下是仅提供值的注释元素示例:</p> <pre class="codeBox"> @InsertNew("yes") </pre> <h2>注释放置</h2> <p>您可以将 Java 注释放在类、接口、方法、方法参数、字段和局部变量之上。下面是添加到类定义上方的注释示例:</p> <pre class="codeBox"> @Entity public class Vehicle { } </pre> <p>注释以<code>@</code>字符开始，后面是注释的名称。在这种情况下，注释名是<code>Entity</code>。<code>Entity</code>注解是我自己编的注解。在 Java 里没有任何意义。</p> <p>下面是一个更大的例子，在类、字段、方法、参数和局部变量上面都有注释:</p> <pre class="codeBox"> <b>@Entity</b> public class Vehicle { <b>@Persistent</b> protected String vehicleName = null; <b>@Getter</b> public String getVehicleName() { return this.vehicleName; } public void setVehicleName(<b>@Optional</b> vehicleName) { this.vehicleName = vehicleName; } public List addVehicleNameToList(List names) { <b>@Optional</b> List localNames = names; if(localNames == null) { localNames = new ArrayList(); } localNames.add(getVehicleName()); return localNames; } } </pre> <p>注释也只是我自己做的注释。它们在 Java 中没有特定的含义。</p> <h2>内置 Java 注释</h2> <p>Java 附带了三个内置注释，用于给 Java 编译器提供指令。这些注释是:</p> <ul> <li>@已弃用</li> <li>@覆盖</li> <li>@ SuppressWarnings</li> <li>@争辩道</li> </ul> <p>下面几节将对这些注释进行解释。</p> <h3>@已弃用</h3> <p><code>@Deprecated</code>注释用于将类、方法或字段标记为不推荐使用，这意味着不再使用它。如果您的代码使用了不推荐使用的类、方法或字段，编译器将向您发出警告。下面是<code>@Deprecated</code> Java 注释的例子:</p> <pre class="codeBox"> @Deprecated public class MyComponent { } </pre> <p>在类声明上使用<code>@Deprecated</code> Java 注释将该类标记为不推荐使用。</p> <p>您还可以使用方法和字段声明上面的<code>@Deprecated</code>注释，将方法或字段标记为不推荐使用。</p> <p>当您使用<code>@Deprecated</code>注释时，最好也使用相应的<code>@deprecated</code> JavaDoc 符号，并解释为什么该类、方法或字段被弃用，以及程序员应该使用什么来代替。例如:</p> <pre class="codeBox"> @Deprecated /** @deprecated Use MyNewComponent instead. */ public class MyComponent { } </pre> <h3>@覆盖</h3> <p>Java 注释用在覆盖超类中方法的方法之上。如果方法与超类中的方法不匹配，编译器会给出一个错误。</p> <p>为了覆盖超类中的方法，<code>@Override</code>注释不是必需的。不过，仍然使用它是个好主意。如果有人改变了超类中被覆盖方法的名称，你的子类方法将不再覆盖它。如果没有<code>@Override</code>注释，您将无法找到答案。有了<code>@Override</code>注释，编译器会告诉你子类中的方法没有覆盖超类中的任何方法。</p> <p>下面是一个<code>@Override</code> Java 注释的例子:</p> <pre class="codeBox"> public class MySuperClass { public void doTheThing() { System.out.println("Do the thing"); } } public class MySubClass extends MySuperClass{ @Override public void doTheThing() { System.out.println("Do it differently"); } } </pre> <p>如果<code>MySuperClass</code>中的方法<code>doTheThing()</code>改变了签名，使得子类中的相同方法不再覆盖它，编译器将产生一个错误。</p> <h3>@ SuppressWarnings</h3> <p><code>@SuppressWarnings</code>注释让编译器禁止给定方法的警告。例如，如果某个方法调用不推荐使用的方法，或者进行不安全的类型转换，编译器可能会生成警告。您可以通过用<code>@SuppressWarnings</code>注释对包含代码的方法进行注释来抑制这些警告。</p> <p>下面是一个<code>@SuppressWarnings</code> Java 注释的例子:</p> <pre class="codeBox"> @SuppressWarnings public void methodWithWarning() { } </pre> <h3>@争辩道</h3> <p><code>@Contended</code>注释<code>@jdk.internal.vm.annotation.Contended</code>用于帮助避免<a href="/java-concurrency/false-sharing.html">错误共享</a>，这是一个并发性能下降的问题。你可以通过上面的链接阅读更多关于 Java 中的虚假共享，以及关于<code>@Contended</code>注释是如何工作的。</p> <h2>创建自己的 Java 注释</h2> <p>可以创建自己的(定制的)Java 注释。注释在它们自己的文件中定义，就像 Java 类或接口一样。顺便说一下，我创建了一个关于创建自己的 Java 注释的视频教程。就在这一段下面可以找到。如果你喜欢文字解释，只需向下滚动视频并继续阅读。</p> <h3>创建自己的 Java 注释视频教程</h3> <iframe width="560" height="315" src="https://www.youtube.com/embed/UlhtkjfxUUU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""/> <h3>自定义 Java 注释示例</h3> <p>以下是自定义 Java 注释示例:</p> <pre class="codeBox"> @interface MyAnnotation { String value(); String name(); int age(); String[] newNames(); } </pre> <p>这个例子定义了一个名为<code>MyAnnotation</code>的注释，它有四个元素。注意<code>@interface</code>关键字。这向 Java 编译器发出信号，表明这是一个 Java 注释定义。</p> <p>请注意，每个元素的定义都类似于接口中的方法定义。它有数据类型和名称。您可以将所有原始数据类型用作元素数据类型。您也可以使用数组作为数据类型。不能使用复杂对象作为数据类型。</p> <p>要使用上述注释，您可以使用如下代码:</p> <pre class="codeBox"> @MyAnnotation( value="123", name="Jakob", age=37, newNames={"Jenkov", "Peterson"} ) public class MyClass { } </pre> <p>如您所见，我必须为<code>MyAnnotation</code>注释的所有元素指定值。</p> <h3>元素默认值</h3> <p>您可以为元素指定默认值。这样，元素就变成可选的，可以省去。下面是一个示例，说明了使用元素默认值时注释定义的外观:</p> <pre class="codeBox"> @interface MyAnnotation { String value() default ""; String name(); int age(); String[] newNames(); } </pre> <p>使用注释时，现在可以省去<code>value</code>元素。如果您忽略它，它将被视为您已经使用了<code>value</code>元素的默认值。下面是一个省略了元素值的注释示例，因此该元素被设置为默认值:</p> <pre class="codeBox"> @MyAnnotation( name="Jakob", age=37, newNames={"Jenkov", "Peterson"} ) public class MyClass { } </pre> <p>请注意，<code>value</code>元素不再存在。</p> <h3>@保留</h3> <p>您可以为您的自定义注释指定它是否应该在运行时可用，以便通过反射进行检查。您可以通过用<code>@Retention</code>注释来注释您的注释定义。这是如何做到的:</p> <pre class="codeBox"> import java.lang.annotation.Retention; import java.lang.annotation.RetentionPolicy; @Retention(RetentionPolicy.RUNTIME) @interface MyAnnotation { String value() default ""; } </pre> <p>注意添加在<code>MyAnnotation</code>定义上方的<code>@Retention</code>注释:</p> <pre class="codeBox"> @Retention(RetentionPolicy.RUNTIME) </pre> <p>这是向 Java 编译器和 JVM 发出的信号，表明注释应该在运行时通过反射可用。在运行时访问注释在我的<a href="/java-reflection/annotations.html"> Java 反射和注释教程</a>中有介绍，它是我的<a href="/java-reflection/index.html"> Java 反射教程</a>的一部分。</p> <p><code>RetentionPolicy</code>类包含另外两个您可以使用的值:</p> <p><code>RetentionPolicy.CLASS</code>表示注释存储在。类文件，但在运行时不可用。如果您没有指定任何保留策略，这是默认的保留策略。</p> <p><code>RetentionPolicy.SOURCE</code>表示注释只在源代码中可用，在。类文件而不是运行时。如果您创建了自己的注释，用于扫描代码的构建工具，那么您可以使用这个保留策略。这样一来。类文件不会受到不必要的污染。</p> <h3>@目标</h3> <p>您可以指定自定义注释可以用来注释哪些 Java 元素。您可以通过用<code>@Target</code>注释来注释您的注释定义。下面是一个<code>@Target</code> Java 注释的例子:</p> <pre class="codeBox"> import java.lang.annotation.ElementType; import java.lang.annotation.Target; @Target({ElementType.METHOD}) public @interface MyAnnotation { String value(); } </pre> <p>这个例子展示了一个只能用来注释方法的 Java 注释。</p> <p><code>ElementType</code>类包含以下可能的目标:</p> <ul> <li>ElementType。注释 _ 类型</li> <li>ElementType。构造器</li> <li>ElementType。领域</li> <li>ElementType。局部变量</li> <li>ElementType。方法</li> <li>ElementType。包裹</li> <li>ElementType。参数</li> <li>元素类型。类型</li> <li>ElementType。类型参数</li> <li>ElementType。类型 _ 用途</li> </ul> <p>大多数是自我解释的，但也有一些不是。因此，我将解释那些不明显的目标。</p> <p><code>ANNOTATION_TYPE</code>目标意味着 Java 注释定义。因此，注释只能用于注释其他注释。比如<code>@Target</code>和<code>@Retention</code>的注解。</p> <p><code>TYPE</code>目标表示任何类型。类型可以是类、接口、枚举或注释。</p> <h3>@继承</h3> <p><code>@Inherited</code>注释表明，一个类中使用的定制 Java 注释应该由继承该类的子类继承。下面是一个<code>@Inherited</code> Java 注释的例子:</p> <pre class="codeBox"> java.lang.annotation.Inherited @Inherited public @interface MyAnnotation { } </pre> <pre class="codeBox"> @MyAnnotation public class MySuperClass { ... } </pre> <pre class="codeBox"> public class MySubClass extends MySuperClass { ... } </pre> <p>在这个例子中，类<code>MySubClass</code>继承了注释<code>@MyAnnotation</code>，因为<code>MySubClass</code>继承了<code>MySuperClass</code>，而<code>MySuperClass</code>有一个<code>@MyAnnotation</code>注释。</p> <h3>@已记录</h3> <p><code>@Documented</code>注释用于向 JavaDoc 工具发出信号，表明您的自定义注释应该在 JavaDoc 中对使用您的自定义注释的类可见。下面是一个<code>@Documented</code> Java 注释的例子:</p> <pre class="codeBox"> import java.lang.annotation.Documented; @Documented public @interface MyAnnotation { } </pre> <pre class="codeBox"> @MyAnnotation public class MySuperClass { ... } </pre> <p>当为<code>MySuperClass</code>类生成 JavaDoc 时，<code>@MyAnnotation</code>现在包含在 JavaDoc 中。</p> <p>您不会经常使用<code>@Documented</code>注释，但是现在您知道它的存在，如果您需要它的话。</p> </body> </html></iframe>